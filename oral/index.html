<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <title>口算生成器 - 在线自动生成口算题并打印 - 壹资源网工具</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="keywords" content="口算生成器, 自动生成口算题, 小学生数学练习, 加减乘除混合运算, 在线打印习题, 隐私安全工具, 壹资源网" />
    <meta name="description" content="壹资源网口算生成器，支持加减乘除及其混合运算，一键生成多份不重复的口算练习题。所有计算均在浏览器本地完成，保护隐私，支持在线打印及另存为 Word。" />

    <!-- Open Graph -->
    <meta property="og:title" content="口算生成器 - 在线自动生成口算题并打印">
    <meta property="og:description" content="一键生成加减乘除混合口算题，支持本地处理，隐私安全，可直接打印。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tool.iezyw.com/oral/">
    <meta property="og:image" content="https://tool.iezyw.com/favicon.ico">
    <link rel="canonical" href="https://tool.iezyw.com/oral/" />

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Outfit:wght@500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.6.0/css/bootstrap.min.css">

    <style>
        :root {
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            --text-color: #ffffff;
            --accent-color: #00d2ff;
            --primary-font: 'Inter', system-ui, -apple-system, sans-serif;
            --header-font: 'Outfit', sans-serif;
        }

        body {
            font-family: var(--primary-font);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            background: #0f172a;
            min-height: 100vh;
        }

        .bg-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            transition: opacity 1.5s ease;
            opacity: 0;
        }

        .bg-overlay.loaded {
            opacity: 1;
        }

        .bg-overlay::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.4) 100%),
                linear-gradient(180deg, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.6) 100%);
        }

        header {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-brand {
            font-family: var(--header-font);
            font-weight: 700;
            font-size: 1.5rem;
            background: linear-gradient(to right, #ffffff, #94a3b8);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: var(--glass-shadow);
            padding: 25px;
            margin-bottom: 30px;
        }

        .hero-section {
            padding: 60px 0 30px;
            text-align: center;
        }

        .hero-section h1 {
            font-family: var(--header-font);
            font-weight: 700;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .btn-custom {
            border-radius: 12px;
            padding: 10px 20px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: 1px solid var(--glass-border);
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .btn-custom:hover,
        .btn-custom.active {
            background: var(--accent-color);
            border-color: transparent;
            box-shadow: 0 5px 15px rgba(0, 210, 255, 0.4);
            color: #fff;
        }

        .form-control-custom {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            color: #fff;
            padding: 8px 12px;
        }

        .form-control-custom:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-color);
            color: #fff;
            box-shadow: none;
        }

        .form-control-custom option {
            background: #1e293b;
            color: #fff;
        }

        #tabdiv {
            background: #fff;
            color: #333;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        td {
            height: 60px;
            padding: 10px;
            font-size: 1.2rem;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            border-bottom: 1px solid #eee;
        }

        .colmode-item,
        .mixmode-item {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .label-text {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        footer {
            padding: 40px 0;
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            margin-top: 60px;
        }

        @media print {
            body {
                background: #fff !important;
                color: #000 !important;
            }

            header,
            .hero-section,
            .glass-card,
            footer,
            .bg-overlay {
                display: none !important;
            }

            #tabdiv {
                box-shadow: none !important;
                padding: 0 !important;
                margin: 0 !important;
                border-radius: 0 !important;
            }

            td {
                border-bottom: none !important;
                padding: 0 !important;
                height: 2.5cm !important;
                /* Force rows to stretch */
                font-size: 1.5rem !important;
                /* Larger text for better filling */
                vertical-align: middle !important;
            }

            table {
                width: 100% !important;
                height: 26cm !important;
                /* Approximate A4 height minus margins */
                page-break-after: always;
            }
        }

        @media (max-width: 768px) {
            .hero-section h1 {
                font-size: 2rem;
            }

            td {
                font-size: 1rem;
                height: 50px;
            }
        }
    </style>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8251016534296673"
     crossorigin="anonymous"></script> 
</head>

<body>
    <div class="bg-overlay" id="dynamic-bg"></div>

    <header>
        <div class="container py-3">
            <div class="d-flex justify-content-between align-items-center">
                <a href="/" class="navbar-brand">
                    <i class="fas fa-tools mr-2"></i>壹资源工具
                </a>
                <div class="d-none d-md-block">
                    <span class="text-white-50 small">提供极简、安全、高效的纯网页在线工具</span>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="hero-section">
            <h1>口算生成器</h1>
            <p class="lead opacity-75">一键生成习题，支持打印。数据处理仅在本地浏览器完成。</p>
        </section>

        <div class="glass-card">
            <div class="d-flex flex-wrap gap-2 mb-4" id="tab">
                <button class="btn btn-custom active mr-2 mb-2" onclick="switchMode(0, this)">按列选模式生成</button>
                <button class="btn btn-custom mb-2" onclick="switchMode(1, this)">按数量混合生成</button>
            </div>

            <div id="ct">
                <!-- Mode 0 -->
                <div class="mode-panel active" id="mode0">
                    <div class="row">
                        <div class="col-md-4 col-sm-6 mb-3">
                            <span class="label-text d-block mb-1">第1列</span>
                            <select id="col1type" class="form-control form-control-custom"></select>
                        </div>
                        <div class="col-md-4 col-sm-6 mb-3">
                            <span class="label-text d-block mb-1">第2列</span>
                            <select id="col2type" class="form-control form-control-custom"></select>
                        </div>
                        <div class="col-md-4 col-sm-6 mb-3">
                            <span class="label-text d-block mb-1">第3列</span>
                            <select id="col3type" class="form-control form-control-custom"></select>
                        </div>
                        <div class="col-md-4 col-sm-6 mb-3">
                            <span class="label-text d-block mb-1">第4列</span>
                            <select id="col4type" class="form-control form-control-custom"></select>
                        </div>
                        <div class="col-md-4 col-sm-6 mb-3">
                            <span class="label-text d-block mb-1">第5列</span>
                            <select id="col5type" class="form-control form-control-custom"></select>
                        </div>
                    </div>
                </div>

                <!-- Mode 1 -->
                <div class="mode-panel d-none" id="mode1">
                    <div class="row" id="mode_option_list">
                        <!-- JS Dynamic -->
                    </div>
                    <div class="alert alert-info py-2 bg-transparent border-info text-info small mt-2">
                        提示：总题数必须等于 50。
                    </div>
                </div>
            </div>

            <hr class="border-secondary opacity-25">

            <div id="act" class="d-flex flex-wrap align-items-center gap-3">
                <button class="btn btn-custom mr-2" onclick="generate()"><i class="fas fa-sync-alt mr-1"></i>
                    重新生成</button>

                <div class="input-group mr-3" style="width: 140px;">
                    <div class="input-group-prepend">
                        <span class="input-group-text bg-transparent border-secondary text-white-50">生成</span>
                    </div>
                    <input type="number" class="form-control form-control-custom" value="1" id="pages" min="1"
                        max="20" />
                    <div class="input-group-append">
                        <span class="input-group-text bg-transparent border-secondary text-white-50">份</span>
                    </div>
                </div>

                <div class="custom-control custom-checkbox mr-3">
                    <input type="checkbox" class="custom-control-input" id="show_answer_cb" onclick="show_issues()">
                    <label class="custom-control-label" for="show_answer_cb">显示答案</label>
                </div>

                <div class="ml-md-auto mt-3 mt-md-0">
                    <button class="btn btn-primary btn-sm mr-2" onclick="printme()"><i class="fas fa-print mr-1"></i>
                        打印习题</button>
                    <button class="btn btn-outline-light btn-sm" onclick="saveasword()"><i
                            class="fas fa-file-word mr-1"></i> 保存为 Word</button>
                </div>
            </div>
        </div>

        <div id="tabdiv" class="print_section"></div>
    </main>

    <footer class="footer text-center">
        <div class="container">
            <p class="text-white-50 mb-0">Copyright &copy; <span id="current-year">2026</span> <a
                    href="http://www.iezyw.com" target="_blank" class="text-accent">壹资源网</a>. All rights reserved.</p>
        </div>
    </footer>

    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/jQuery.print.js"></script>
    <script type="text/javascript" src="js/jquery.base64.js"></script>
    <script type="text/javascript" src="js/libs/FileSaver/FileSaver.min.js"></script>

    <!-- <script type="text/javascript" src="js/libs/jsPDF/jspdf.min.js"></script>
    <script type="text/javascript" src="js/libs/jsPDF-AutoTable/jspdf.plugin.autotable.js"></script>
    <script type="text/javascript" src="js/pdfmake/pdfmake.js"></script>
    <script type="text/javascript" src="js/pdfmake/vfs_fonts.js"></script> -->

    <script type="text/javascript" src="js/tableExport.js"></script>

    <script type="text/javascript">
        // 原有模式定义保持不变
        var modes = [
            ["add_1_1", "一位数加一位数"],
            ["addc_2_2", "两位数进位加法"],
            ["add_2_2", "两位数不进位加"],
            ["subc_2_2", "两位数退位减法"],
            ["sub_2_2", "两位数不退位减"],
            ["add_1_2", "一位数加两位数"],
            ["add_2_1", "两位数加一位数"],
            ["sub_2_1", "两位数减一位数"],
            ["mul_1_1", "一位数乘一位数"],
            ["addmul_2_1_1", "两位数加一位数乘"],
            ["muladd_1_1_2", "一位数乘加两位数"],
            ["mulsub_1_1_2", "一位数乘减两位数"],
            ["submul_2_1_1", "两位数减一位数乘"],
            ["sub9", "减数个位为9"],
            ["sub012", "减数个位为012"],
            ["add012", "加数个位为012"],
            ["addn_2_2", "特殊非进位加"],
            ["wrong", "历史错题"],
        ];

        var wrong_issues = [
            [1, 46, '-', 31, 15],
            [1, 43, '+', 40, 83],
            [1, 27, '+', 30, 57],
            [1, 49, '+', 30, 79],
            [1, 56, '-', 21, 35],
            [1, 97, '-', 59, 38],
            [2, 6, 'x', 5, '-', 29, 1],
            [1, 76, '-', 59, 17],
            [2, 8, 'x', 6, '-', 12, 36],
            [2, 45, '+', 2, 'x', 6, 57],
            [2, 42, '+', 2, 'x', 3, 48],
            [1, 63, '+', 10, 73],
            [1, 62, '+', 16, 78]
        ];

        var current_wrong = 0;

        function rand(m, n) {
            if (m > n) return 0;
            return Math.round(Math.random() * (n - m) + m);
        }

        function generate_issue(type) {
            var i, j, k, l;
            var issue = new Object();
            issue.op_n = 1;
            issue.op = new Array();
            issue.opr = new Array();

            switch (type) {
                case 'add_1_1':
                    i = rand(1, 9); j = rand(1, 9);
                    issue.opr[0] = i; issue.op[0] = '+'; issue.opr[1] = j;
                    issue.result = i + j; break;
                case 'addc_2_2':
                    i = rand(1, 7); j = rand(1, 9);
                    issue.opr[0] = i * 10 + j; issue.op[0] = '+';
                    issue.opr[1] = rand(1, 8 - i) * 10 + rand(10 - j, 9);
                    issue.result = issue.opr[0] + issue.opr[1]; break;
                case 'add_2_2':
                    i = rand(1, 8); j = rand(0, 9);
                    issue.opr[0] = i * 10 + j; issue.op[0] = '+';
                    issue.opr[1] = rand(1, 9 - i) * 10 + rand(0, 9 - j);
                    issue.result = issue.opr[0] + issue.opr[1]; break;
                case 'subc_2_2':
                    i = rand(2, 9); j = rand(0, 8);
                    issue.opr[0] = i * 10 + j; issue.op[0] = '-';
                    issue.opr[1] = rand(1, i - 1) * 10 + rand(j + 1, 9);
                    issue.result = issue.opr[0] - issue.opr[1]; break;
                case 'sub_2_2':
                    i = rand(1, 9); j = rand(0, 9);
                    issue.opr[0] = i * 10 + j; issue.op[0] = '-';
                    issue.opr[1] = rand(1, i) * 10 + rand(0, j);
                    issue.result = issue.opr[0] - issue.opr[1]; break;
                case 'add_2_1':
                    i = rand(1, 9); j = rand(0, 9);
                    issue.opr[0] = i * 10 + j; issue.op[0] = '+';
                    issue.opr[1] = (i < 9) ? rand(0, 9) : rand(0, 9 - j);
                    issue.result = issue.opr[0] + issue.opr[1]; break;
                case 'add_1_2':
                    i = rand(1, 9); j = rand(1, 9);
                    issue.opr[0] = i; issue.op[0] = '+';
                    issue.opr[1] = (j == 9) ? j * 10 + rand(0, 9 - i) : j * 10 + rand(0, 9);
                    issue.result = issue.opr[0] + issue.opr[1]; break;
                case 'sub_2_1':
                    i = rand(1, 9); j = rand(0, 9);
                    issue.opr[0] = i * 10 + j; issue.op[0] = '-';
                    issue.opr[1] = rand(0, 9);
                    issue.result = issue.opr[0] - issue.opr[1]; break;
                case 'mul_1_1':
                    i = rand(1, 9); j = rand(1, 9);
                    issue.opr[0] = i; issue.op[0] = 'x'; issue.opr[1] = j;
                    issue.result = i * j; break;
                case 'addmul_2_1_1':
                    i = rand(1, 99); j = rand(1, 9); k = rand(1, 9);
                    issue.op_n = 2; issue.opr[0] = i; issue.op[0] = '+'; issue.opr[1] = j; issue.op[1] = 'x'; issue.opr[2] = k;
                    issue.result = i + j * k; break;
                case 'submul_2_1_1':
                    j = rand(1, 9); k = rand(1, 9); i = rand(j * k, 100);
                    issue.op_n = 2; issue.opr[0] = i; issue.op[0] = '-'; issue.opr[1] = j; issue.op[1] = 'x'; issue.opr[2] = k;
                    issue.result = i - j * k; break;
                case 'muladd_1_1_2':
                    i = rand(1, 9); j = rand(1, 9); k = rand(1, 99);
                    issue.op_n = 2; issue.opr[0] = i; issue.op[0] = 'x'; issue.opr[1] = j; issue.op[1] = '+'; issue.opr[2] = k;
                    issue.result = i * j + k; break;
                case 'mulsub_1_1_2':
                    i = rand(4, 9); j = rand(4, 9); k = rand(1, i * j);
                    issue.op_n = 2; issue.opr[0] = i; issue.op[0] = 'x'; issue.opr[1] = j; issue.op[1] = '-'; issue.opr[2] = k;
                    issue.result = i * j - k; break;
                case 'sub9':
                    j = rand(1, 8); i = rand(j + 1, 9);
                    issue.opr[0] = i * 10 + rand(0, 9); issue.op[0] = '-'; issue.opr[1] = j * 10 + 9;
                    issue.result = issue.opr[0] - issue.opr[1]; break;
                case 'sub012':
                    i = rand(2, 9); j = rand(0, 2);
                    issue.opr[0] = i * 10 + rand(5, 9); issue.op[0] = '-';
                    issue.opr[1] = rand(0, i - 1) * 10 + j;
                    issue.result = issue.opr[0] - issue.opr[1]; break;
                case 'add012':
                    i = rand(1, 8); j = rand(1, 9 - i); k = rand(0, 2);
                    issue.opr[0] = i * 10 + rand(0, 9 - k); issue.op[0] = '+';
                    issue.opr[1] = j * 10 + k;
                    issue.result = issue.opr[0] + issue.opr[1]; break;
                case 'addn_2_2':
                    do {
                        i = rand(1, 8); j = rand(0, 9); k = rand(0, 9 - j); l = rand(1, 9 - i);
                    } while (i + k < 10 && j + l < 10);
                    issue.opr[0] = i * 10 + j; issue.op[0] = '+'; issue.opr[1] = l * 10 + k;
                    issue.result = issue.opr[0] + issue.opr[1]; break;
                case 'wrong':
                    i = current_wrong;
                    j = 0;
                    k = wrong_issues[i][j++];
                    issue.op_n = k;
                    issue.opr[0] = wrong_issues[i][j++];
                    issue.op[0] = wrong_issues[i][j++];
                    issue.opr[1] = wrong_issues[i][j++];
                    if (k == 2) {
                        issue.op[1] = wrong_issues[i][j++];
                        issue.opr[2] = wrong_issues[i][j++];
                    }
                    issue.result = wrong_issues[i][j];
                    current_wrong = (current_wrong + 1) % wrong_issues.length;
                    break;
                default:
                    alert("unknown type=" + type);
            }
            return issue;
        }

        function generate_issues(type, n) {
            var res = [];
            for (var i = 0; i < n; i++) res.push(generate_issue(type));
            return res;
        }

        var MAX_PAGES = 20;
        var CELLS_PER_PAGE = 50;
        var ROWS_PER_PAGE = 10;
        var cells = new Array(MAX_PAGES * CELLS_PER_PAGE);
        var current_mode = 0;
        var old_total_pages = 0;
        var total_pages = 0;

        function print_issue(issue, show_answer) {
            var s = '<td>';
            s += issue.opr[0] + ' ' + issue.op[0] + ' ' + issue.opr[1];
            if (issue.op_n == 2) s += ' ' + issue.op[1] + ' ' + issue.opr[2];
            s += ' = ';
            if (show_answer) s += '<span class="text-primary">' + issue.result + '</span>';
            s += '</td>';
            return s;
        }

        function create_table(p) {
            var tab = document.createElement("table");
            tab.setAttribute("id", "mytab" + p);
            tab.className = "table mb-5";
            for (var r = 0; r <= ROWS_PER_PAGE; r++) {
                var tr = tab.insertRow(r);
                if (r == 0) {
                    tr.innerHTML = '<tr><td colspan="5" class="py-2 border-0">\
                        <div class="d-flex justify-content-around font-weight-bold" style="font-size: 1.2rem;">\
                            <span>姓名：__________</span>\
                            <span>班级：__________</span>\
                            <span>用时：__________</span>\
                        </div></td></tr>';
                } else {
                    for (var c = 0; c < 5; c++) tr.insertCell(c);
                }
            }
            document.getElementById("tabdiv").appendChild(tab);
            return tab;
        }

        function show_issues() {
            var show_answer = document.getElementById("show_answer_cb").checked;
            for (var p = 0; p < total_pages; p++) {
                var tab = document.getElementById("mytab" + p) || create_table(p);
                for (var r = 0; r < ROWS_PER_PAGE; r++) {
                    var tr = tab.rows[r + 1];
                    for (var c = 0; c < 5; c++) {
                        tr.cells[c].innerHTML = print_issue(cells[p * CELLS_PER_PAGE + c * ROWS_PER_PAGE + r], show_answer);
                    }
                }
            }
            var d = document.getElementById("tabdiv");
            for (var p = old_total_pages - 1; p >= total_pages; p--) {
                var tab = document.getElementById("mytab" + p);
                if (tab) d.removeChild(tab);
            }
            old_total_pages = total_pages;
        }

        function generate() {
            var pages = parseInt(document.getElementById("pages").value);
            if (isNaN(pages) || pages < 1 || pages > MAX_PAGES) {
                alert("无效份数 (1-20)"); return;
            }
            total_pages = pages;
            if (current_mode == 0) generate_mode1();
            else generate_mode2();
        }

        function generate_mode1() {
            var cols = ["col1type", "col2type", "col3type", "col4type", "col5type"];
            for (var p = 0; p < total_pages; p++) {
                for (var i = 0; i < 5; i++) {
                    var mode = document.getElementById(cols[i]).value;
                    var issues = generate_issues(mode, ROWS_PER_PAGE);
                    for (var j = 0; j < ROWS_PER_PAGE; j++) cells[p * CELLS_PER_PAGE + i * ROWS_PER_PAGE + j] = issues[j];
                }
            }
            show_issues();
        }

        function generate_mode2() {
            var n = [], total = 0;
            for (var i = 0; i < modes.length; i++) {
                var val = parseInt(document.getElementById(modes[i][0]).value || 0);
                n.push(val); total += val;
            }
            if (total != 50) { alert("总题数必须为 50，当前为 " + total); return; }

            for (var p = 0; p < total_pages; p++) {
                var current_cells = [];
                for (var i = 0; i < modes.length; i++) {
                    if (n[i] > 0) current_cells = current_cells.concat(generate_issues(modes[i][0], n[i]));
                }
                current_cells.sort(function () { return 0.5 - Math.random(); });
                for (var i = 0; i < CELLS_PER_PAGE; i++) cells[p * CELLS_PER_PAGE + i] = current_cells[i];
            }
            show_issues();
        }

        function switchMode(idx, btn) {
            current_mode = idx;
            $("#tab .btn").removeClass("active");
            $(btn).addClass("active");
            if (idx == 0) {
                $("#mode0").removeClass("d-none").addClass("active");
                $("#mode1").addClass("d-none").removeClass("active");
            } else {
                $("#mode1").removeClass("d-none").addClass("active");
                $("#mode0").addClass("d-none").removeClass("active");
            }
        }

        function create_options() {
            for (var i = 1; i <= 5; i++) {
                var select = document.getElementById("col" + i + "type");
                modes.forEach(m => select.options.add(new Option(m[1], m[0])));
            }
            var list = document.getElementById("mode_option_list");
            modes.forEach(m => {
                var col = document.createElement("div");
                col.className = "col-md-4 col-sm-6 mb-2";
                col.innerHTML = `
                    <div class="mixmode-item">
                        <span class="label-text">${m[1]}</span>
                        <input id="${m[0]}" type="number" class="form-control form-control-custom" value="0" style="width: 70px;" />
                    </div>`;
                list.appendChild(col);
            });
        }

        function setRandomBg() {
            const bgOverlay = document.getElementById('dynamic-bg');
            const randomUrl = `https://picsum.photos/1920/1080?random=${Date.now()}`;
            const img = new Image();
            img.src = randomUrl;
            img.onload = () => {
                bgOverlay.style.backgroundImage = `url('${randomUrl}')`;
                bgOverlay.classList.add('loaded');
            };
        }

        window.onload = function () {
            create_options();
            generate();
            setRandomBg();
            document.getElementById('current-year').textContent = new Date().getFullYear();
        }

        function printme() { $("#tabdiv").print(); }
        function saveasword() {
            $("table").tableExport({
                type: 'doc',
                escape: 'false',
                excelstyles: ['height', 'width', 'text-align', 'font-size', 'align']
            });
        }
    </script>
</body>

</html>